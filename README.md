# Общая информация

Программа предназначена для получения распределения читателей по топикам для портала Ведомости (https://www.vedomosti.ru/).

Общая логика работы:
1) У нас имеется некоторая информация о посетителях портала Ведомостей за прошедший месяц (на основе данных https://www.similarweb.com/ru/) 
```
vedomosti_info = {
    "total_visitors" : 63810000,
    "device" : {"Desktop" : 18.27, "Mobile" : 81.73},
    "monthly_visits" : 21270000,
    "monthly_unique_visitors" : 9927000,
    "deduplicated_audience" : 8764000,
    "country" : {"Russia" : 86.07, "Germany" : 1.95, "Ukraine" : 1.73, "Belarus" : 1.48, "Kazakhstan" : 1.43},
    "gender_distribution" : {"Male" : 67.28,"Female" : 32.72},
    "age_distribution" : {"18-24" : 9.34, "25-34" : 16.51, "35-44" : 13.55, "45-54" : 14.68, "55-64" : 18.44, "65+" : 27.49}       
}
```

2) У нас имеется некоторый портрет читателей определенных топиков (данные были составлены преимущественно случайным образом, но по-хорошему тут нужно отдельный ресерч проводить, какие социальные/возрастные/половые группы отслеживают определенную тематику в большей степени, нежели другие). Данные приведены в файле info.py


3) Была подготовлена модель для классификации текстов на 10 топиков (lifestyle, opinions, politics, technologies, realty, business, management, auto, finances, economics) на базе открытых статей с портала Ведомостей. 
* Модель - https://huggingface.co/kartashoffv/news_topic_classification
* Датасет - https://huggingface.co/datasets/kartashoffv/vedomosti_articles

4) Программа принимает текста от пользователя, которые прогоняются через модель. Модель выдает вероятностные топики, к которым может относится представленные текста.

5) Поскольку у нас есть инфа о целевой аудитории топика и целевой аудитории сайта, наша задача сводится к тому, чтобы посмотреть, как распределилась целевая аудитория топиков на нашем портале.


# Зависимости

1) Flask
```
pip install Flask
```

2) Transformers
```
pip install transformers
```

3) Python 3.10.

+ стандартные модули Python (json, codecs, и requests).

# Запуск приложения

Для запуска Flask-приложения можно использовать Docker Compose:

1) открыть терминал
2) перейти в директорию проекта (TEST_NEOBIT) (разархивировать папку)
3) запустить контейнер
```
docker-compose up
```
4) открыть терминал в новом окне 

5) отправить текста (поставить свои текста в массив с ключем "texts")
```
curl POST -H "Content-Type: application/json" -d '{"texts": ["Текст 1", "Текст2", "Текст3..."]}' http://0.0.0.0:5000/add_text
```
6) получить распределения
```
curl http://0.0.0.0:5000/get_distr
```


# Endpoints

В приложении два еndpoints:

1) /add_text - добавление текстов.
    * Метод: POST
    * Параметры запроса (в формате JSON):
    * texts (обязательный параметр) - это должен быть список текстов. Каждый текст должен быть строкой.


Пример запроса:
```
POST /add_text
{
    "texts": ["Текст 1", "Текст 2", "Текст 3"]
}
```
Пример успешного ответа:
```
{
    "message": "Texts added successfully"
}
```

/get_distr - получение данных о текстах.

    Метод: GET

Пример запроса:

```
GET /get_distr
```

Пример успешного ответа:

```
{
        "texts": [
            "topic" : {distribution_info},
            "topic" : {distribution_info},
            "topic" : {distribution_info}
        ]
    }
```

